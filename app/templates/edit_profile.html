{% extends 'base.html' %}

{% block title %}Редактирование профиля{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center">Редактирование профиля</h2>
    <form method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <div class="mb-3">
            {{ form.student_name.label(class="form-label") }}
            {{ form.student_name(class="form-control") }}
            {% for error in form.student_name.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.student_surname.label(class="form-label") }}
            {{ form.student_surname(class="form-control") }}
            {% for error in form.student_surname.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.student_patronymic.label(class="form-label") }}
            {{ form.student_patronymic(class="form-control") }}
        </div>

        <div class="mb-3">
            {{ form.grade.label(class="form-label") }}
            {{ form.grade(class="form-control") }}
        </div>

        <div class="mb-3">
            {{ form.email.label(class="form-label") }}
            {{ form.email(class="form-control") }}
            {% for error in form.email.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.phone_number.label(class="form-label") }}
            {{ form.phone_number(class="form-control") }}
        </div>

        <div class="mb-3">
            {{ form.photo.label(class="form-label") }}
            {{ form.photo(class="form-control") }}
            {% for error in form.photo.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.bio.label(class="form-label") }}
            {{ form.bio(class="form-control", rows=3) }}
        </div>

        <!-- Контейнер для кнопок -->
        <div class="d-flex justify-content-between mt-4">
            <div>
                {{ form.submit(class="btn btn-primary") }}
            </div>
            <div>
                <a href="javascript:history.back()" class="btn btn-light shadow-sm">Назад</a>
            </div>
        </div>
    </form>
</div>

<script>
    window.onload = function() {
        const currentUrl = window.location.href;
        const previousUrl = localStorage.getItem('previousUrl');
        if (!previousUrl || previousUrl !== currentUrl) {
            localStorage.setItem('previousUrl', currentUrl);
        }

        document.getElementById('backButton').onclick = function() {
            const previousUrl = localStorage.getItem('previousUrl');
            if (previousUrl) {
                window.location.href = previousUrl;
            } else {
                window.history.back();
            }
        };
    };
</script>
{% endblock %}
