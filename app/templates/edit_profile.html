{% extends 'base.html' %}

{% block title %}Редактирование профиля{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center">Редактирование профиля</h2>
    <form method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <div class="mb-3">
            {{ form.student_name.label(class="form-label") }}
            {{ form.student_name(class="form-control") }}
            {% for error in form.student_name.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.student_surname.label(class="form-label") }}
            {{ form.student_surname(class="form-control") }}
            {% for error in form.student_surname.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.student_patronymic.label(class="form-label") }}
            {{ form.student_patronymic(class="form-control") }}
            {% for error in form.student_patronymic.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.grade.label(class="form-label") }}
            {{ form.grade(class="form-control") }}
            {% for error in form.grade.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.email.label(class="form-label") }}
            {{ form.email(class="form-control") }}
            {% for error in form.email.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.phone_number.label(class="form-label") }}
            {{ form.phone_number(class="form-control") }}
            {% for error in form.phone_number.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.photo.label(class="form-label") }}
            {{ form.photo(class="form-control") }}
            {% for error in form.photo.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>

        <div class="mb-3">
            {{ form.bio.label(class="form-label") }}
            {{ form.bio(class="form-control", rows=3) }}
        </div>

        <!-- Контейнер для кнопок -->
        <div class="d-flex justify-content-between mt-4">
            <div>
                {{ form.submit(class="btn btn-primary") }}
            </div>
            <div>
                <button type="button" id="backButton" class="btn btn-light shadow-sm">Назад</button>
            </div>
        </div>
    </form>
</div>

<script>
    window.onload = function() {
        const backButton = document.getElementById('backButton');
        const previousUrl = document.referrer;

        // Устанавливаем обработчик клика для кнопки "Назад"
        backButton.onclick = function() {
            if (previousUrl) {
                window.location.href = previousUrl;
            } else {
                window.history.back();
            }
        };

        // Отображение имени выбранного файла
        const fileInput = document.querySelector('input[type="file"]');
        const fileLabel = document.createElement('div');
        fileLabel.className = 'mt-2';
        fileInput.parentNode.appendChild(fileLabel);

        fileInput.onchange = function() {
            if (fileInput.files.length > 0) {
                fileLabel.textContent = `Выбран файл: ${fileInput.files[0].name}`;
            } else {
                fileLabel.textContent = '';
            }
        };
    };
</script>
{% endblock %}
